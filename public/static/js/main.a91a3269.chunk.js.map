{"version":3,"sources":["Config.js","components/MyButton.js","components/SettingsDialog.js","utils/DataBeans.js","App.js","reportWebVitals.js","index.js"],"names":["Config","ITEM_NAME","this","load","bind","save","theme_avaliable","createMuiTheme","dark","palette","type","key_mapping_templates","left","right","up","down","start","stop","writing","laser","ink","data_default","debug","version_frontend","api","url_config","used_hand","remote_servers","theme_name","key_mapping_name","data","theme","key_mapping","console","log","JSON","parse","localStorage","getItem","Error","k","e","warn","setItem","stringify","MyButton","props","icon","text","color","onClick","style","width","display","justifyContent","flexDirection","alignItems","IconButton","aria-label","Typography","variant","React","Component","dataWrapper","cmd","result","Alert","elevation","App","orientationHandler","event","state","connected","ws","alpha","angleInit","beta","gamma","send","dataAngleFrame","render","connectStart","connectEnd","handleButtons","handleMouseClick","handleSettingsClose","config","connecting","orientation","openSettings","playing","test_text","window","DeviceOrientationEvent","addEventListener","throttle","method","delay","duration","timer","begin","Date","context","args","arguments","current","clearTimeout","apply","setTimeout","WebSocket","onopen","setState","onclose","onerror","error","close","button","keys","mouse_key","document","querySelector","value","ThemeProvider","Container","maxWidth","Grid","container","spacing","item","xs","SettingsIcon","severity","PowerSettingsNewIcon","AvTimerIcon","ExitToAppIcon","connectStop","ButtonGroup","Button","disableElevation","height","size","position","bottom","Dialog","onClose","open","DialogTitle","TextField","id","label","defaultValue","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a91a3269.chunk.js","sourcesContent":["import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, gray } from '@material-ui/core/colors';\r\n\r\nclass Config {\r\n  ITEM_NAME = \"magic_mouse_config\";\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"default\": createMuiTheme({}),\r\n      dark: createMuiTheme({\r\n        palette: {\r\n          type: \"dark\"\r\n        },\r\n      }),\r\n    }\r\n    // 按键映射数据\r\n    this.key_mapping_templates = {\r\n      \"default\": {\r\n        left: [\"left\"],\r\n        right: [\"right\"],\r\n        up: [\"up\"],\r\n        down: [\"down\"],\r\n        start: [\"f5\"],\r\n        stop: [\"esc\"],\r\n        writing: [\"ctrl\", 'p'],\r\n        laser: [\"ctrl\", 'l'],\r\n        ink: ['ctrl', 'm']\r\n      }\r\n    };\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.11,\r\n      api: \"ws://10.251.124.73/api/v1/ws\",\r\n      // 设置页面地址\r\n      url_config: \"/config\",\r\n      // 惯用手\r\n      used_hand: \"right\",\r\n      // 可用的远程服务器列表\r\n      remote_servers: [\r\n        'http://server.chiro.work:10086',\r\n      ],\r\n      // 显示主题\r\n      theme_name: \"default\",\r\n      theme_avaliable: [\r\n        'default',\r\n        'dark'\r\n      ],\r\n      // 按键映射\r\n      key_mapping_name: \"default\"\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"default\"];\r\n    this.key_mapping = this.key_mapping_templates['default'];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading magic mouse config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(this.ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${this.ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    this.key_mapping = this.key_mapping_templates[this.data.key_mapping_name];\r\n    if (!this.key_mapping) this.key_mapping = this.key_mapping_templates['default'];\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving magic mouse config...\");\r\n    localStorage.setItem(this.ITEM_NAME, JSON.stringify(this.data));\r\n  }\r\n};\r\n\r\nexport default Config;","import React from \"react\"\r\nimport { Button } from '@material-ui/core';\r\nimport { Typography } from '@material-ui/core';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\r\n\r\nclass MyButton extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.icon = props.icon;\r\n    this.text = props.text;\r\n    this.color = props.color ? props.color : \"primary\";\r\n    this.onClick = props.onClick;\r\n  }\r\n  render() {\r\n    return (<div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n      <IconButton aria-label=\"play\" color={this.color} onClick={this.onClick}>\r\n        <this.icon />\r\n      </IconButton>\r\n      <Typography variant=\"caption\" display=\"block\" style={{ color: \"#9e9e9e\" }}>\r\n        {this.text}\r\n      </Typography>\r\n    </div>);\r\n  }\r\n};\r\n\r\nexport default MyButton;","import React from 'react'\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\n\r\nclass SettingsDialog extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.config = props.config;\r\n    this.state = {\r\n      open: props.open,\r\n      data: {},\r\n    };\r\n  }\r\n\r\n  handleClose() {\r\n    console.log(\"Closed\");\r\n    this.setState({\r\n      open: false\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Dialog onClose={this.handleClose} open={this.state.open}>\r\n        <DialogTitle>设置</DialogTitle>\r\n      </Dialog>\r\n    );\r\n  }\r\n};\r\n\r\n\r\nexport default SettingsDialog;\r\n","function dataWrapper(cmd, data) {\r\n  if (!data) return {\r\n    cmd: cmd\r\n  };\r\n  let result = {\r\n    cmd: cmd,\r\n    data: data\r\n  };\r\n  if (cmd != \"data_angle_frame\")\r\n    console.log(\"DataWrapper: will send\", result);\r\n  return result;\r\n}\r\nfunction dataAngleFrame(event) {\r\n  return dataWrapper(\"data_angle_frame\", {\r\n    alpha: event.alpha,\r\n    beta: event.beta,\r\n    gamma: event.gamma\r\n  })\r\n}\r\n\r\nexport { dataAngleFrame, dataWrapper };","import React from \"react\"\r\nimport { Button } from '@material-ui/core';\r\nimport MouseIcon from '@material-ui/icons/Mouse';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Container from '@material-ui/core/Container';\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\r\nimport Config from \"./Config\"\r\nimport MyButton from \"./components/MyButton\"\r\nimport { makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport PowerSettingsNewIcon from '@material-ui/icons/PowerSettingsNew';\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\r\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\r\nimport AvTimerIcon from '@material-ui/icons/AvTimer';\r\nimport SlideshowIcon from '@material-ui/icons/Slideshow';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport SettingsDialog from './components/SettingsDialog'\r\nimport { dataAngleFrame, dataWrapper } from \"./utils/DataBeans\"\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.orientationHandler = this.orientationHandler.bind(this);\r\n    this.render = this.render.bind(this);\r\n    this.connectStart = this.connectStart.bind(this);\r\n    this.connectEnd = this.connectEnd.bind(this);\r\n    this.handleButtons = this.handleButtons.bind(this);\r\n    this.handleMouseClick = this.handleMouseClick.bind(this);\r\n    this.handleSettingsClose = this.handleSettingsClose.bind(this);\r\n\r\n    this.config = new Config();\r\n    // 没开始连接，未初始化\r\n    this.ws = null;\r\n    this.connecting = false;\r\n    // 初始化\r\n    this.angleInit = null;\r\n\r\n    this.state = {\r\n      orientation: {},\r\n      openSettings: false,\r\n      connected: false,\r\n      playing: false,\r\n      writing: false,\r\n      laser: false,\r\n      ink: true,\r\n      test_text: \"\",\r\n    };\r\n\r\n    if (window.DeviceOrientationEvent) {\r\n      window.addEventListener(\"deviceorientation\", this.throttle(this.orientationHandler, 20, 20), false);\r\n    } else {\r\n      console.log(\"Does not support deviceorientation!\");\r\n    };\r\n    console.log(this.config);\r\n    console.log(this.config.theme);\r\n\r\n    this.test_text = \"\";\r\n  }\r\n\r\n  throttle(method, delay, duration) {\r\n    var timer = null,\r\n      begin = new Date();\r\n    return function () {\r\n      var context = this,\r\n        args = arguments,\r\n        current = new Date();\r\n      clearTimeout(timer);\r\n      if (current - begin >= duration) {\r\n        method.apply(context, args);\r\n        begin = current;\r\n      } else {\r\n        timer = setTimeout(function () {\r\n          method.apply(context, args);\r\n        }, delay);\r\n      }\r\n    }\r\n  }\r\n\r\n  orientationHandler = (event) => {\r\n    if (!this.state.connected || !this.ws) return;\r\n    if (typeof (event.alpha) === 'null') {\r\n      console.warn(\"Handle: null event!\");\r\n      return;\r\n    }\r\n    if (!this.angleInit) {\r\n      this.angleInit = {\r\n        alpha: event.alpha,\r\n        beta: event.beta,\r\n        gamma: event.gamma\r\n      }\r\n    }\r\n    this.ws.send(JSON.stringify(dataAngleFrame({\r\n      alpha: event.alpha - this.angleInit.alpha,\r\n      beta: event.beta - this.angleInit.beta,\r\n      gamma: event.gamma - this.angleInit.gamma\r\n    })));\r\n    // console.log(\"orientation\", event);\r\n  }\r\n\r\n  connectStart() {\r\n    this.connecting = true;\r\n    try {\r\n      this.ws = new WebSocket(this.config.data.api);\r\n      this.ws.onopen = () => {\r\n        console.log(\"Ws: connected.\");\r\n        this.ws.send(JSON.stringify(dataWrapper(\"start\")));\r\n        this.setState({\r\n          connected: true\r\n        });\r\n      };\r\n      this.ws.onclose = () => {\r\n        this.setState({\r\n          connected: false\r\n        });\r\n        console.log(\"Ws: closed.\");\r\n        this.ws = null;\r\n      };\r\n      this.ws.onerror = () => {\r\n        console.error(\"Websocket Error!!!\");\r\n      };\r\n    } catch (e) {\r\n      console.error('Error when trying to connect!', e);\r\n    }\r\n    this.connecting = false;\r\n    console.log('this.ws', this.ws);\r\n  }\r\n\r\n  connectEnd() {\r\n    if (!this.ws || !this.state.connected || this.connecting) return;\r\n    this.ws.close();\r\n    this.angleInit = null;\r\n  }\r\n\r\n  connectStop() {\r\n    if (!this.ws || !this.state.connected || this.connecting) return;\r\n    this.ws.send(JSON.stringify(dataWrapper(\"stop_from_client\")));\r\n    this.connectEnd();\r\n  }\r\n\r\n  handleButtons(button) {\r\n    console.log(\"handleButtons:\", button);\r\n    if (!button || !this.state.connected || !this.ws) return;\r\n    let keys = this.config.key_mapping[button];\r\n    if (!keys) return;\r\n\r\n    this.ws.send(JSON.stringify(dataWrapper(\"key\", {\r\n      keys: keys\r\n    })));\r\n  }\r\n\r\n  handleMouseClick(button) {\r\n    console.log(\"handleMouseClick:\", button);\r\n    if (!this.state.connected || !this.ws) return;\r\n\r\n    this.ws.send(JSON.stringify(dataWrapper(\"mouse\", {\r\n      mouse_key: button\r\n    })));\r\n  }\r\n\r\n  handleSettingsClose() {\r\n    this.setState({ openSettings: false });\r\n    console.log(\"Settings: got\", document.querySelector(\"#settings-api\").value);\r\n    this.config.data.api = document.querySelector(\"#settings-api\").value;\r\n    this.config.save();\r\n  }\r\n\r\n  render() {\r\n    return (<div>\r\n      <ThemeProvider theme={this.config.theme}>\r\n        <Container maxWidth=\"xs\">\r\n          <div style={{ width: \"100%\" }}>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={4}>\r\n                <MyButton icon={SettingsIcon} text={\"设置\"} onClick={() => {\r\n                  console.log(\"Opening settings...\");\r\n                  this.setState({\r\n                    openSettings: true\r\n                  });\r\n                }}></MyButton>\r\n              </Grid>\r\n              <Grid item xs={1}>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Alert severity=\"info\">正在计时...</Alert>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={4}>\r\n                <MyButton icon={PowerSettingsNewIcon} color={this.state.connected ? \"secondary\" : \"default\"} text={\"连接\"} onClick={() => {\r\n                  if (this.connecting) return;\r\n                  if (!this.state.connected) {\r\n                    this.connectStart();\r\n                  } else {\r\n                    this.connectEnd();\r\n                  }\r\n                }}></MyButton>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <MyButton icon={AvTimerIcon} text={\"计时\"}></MyButton>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <MyButton icon={ExitToAppIcon} text={\"关闭\"} onClick={() => {\r\n                  this.connectStop();\r\n                }}></MyButton>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={5}>\r\n                <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\r\n                  <ButtonGroup color=\"primary\">\r\n                    <Button onClick={() => {\r\n                      this.handleButtons(\"start\");\r\n                      this.setState({ playing: true });\r\n                    }}>开始</Button>\r\n                    <Button onClick={() => {\r\n                      this.handleButtons(\"stop\");\r\n                    }}>退出</Button>\r\n                  </ButtonGroup>\r\n                </div>\r\n              </Grid>\r\n              <Grid item xs={7}>\r\n                <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\r\n                  <ButtonGroup color=\"primary\">\r\n                    <Button variant={this.state.writing ? \"contained\" : \"outlined\"} disableElevation onClick={() => {\r\n                      this.handleButtons(\"writing\");\r\n                      this.setState({ writing: !this.state.writing, laser: this.state.laser ? false : this.state.laser });\r\n                    }}>书写</Button>\r\n                    <Button variant={this.state.laser ? \"contained\" : \"outlined\"} disableElevation onClick={() => {\r\n                      this.handleButtons(\"laser\");\r\n                      this.setState({ laser: !this.state.laser, writing: this.state.writing ? false : this.state.writing });\r\n                    }}>激光</Button>\r\n                    <Button variant={this.state.ink ? \"contained\" : \"outlined\"} disableElevation onClick={() => {\r\n                      this.handleButtons(\"ink\");\r\n                      this.setState({ ink: !this.state.ink });\r\n                    }}>墨迹</Button>\r\n                  </ButtonGroup>\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n          <div style={{ width: \"100%\", height: \"100%\" }}>\r\n            <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\" }}>\r\n              <Button size=\"large\" color=\"primary\" style={{ width: 100 }} onClick={() => { this.handleButtons(\"up\"); }}>·</Button>\r\n            </div>\r\n            <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\r\n              <Button size=\"large\" color=\"primary\" style={{ height: 100 }} onClick={() => { this.handleButtons(\"left\"); }}>·</Button>\r\n              <IconButton aria-label=\"play\" style={{ height: 100, width: 100 }} onClick={() => { this.handleMouseClick(0); }}>\r\n                <MouseIcon style={{ height: 100, width: 100 }} />\r\n              </IconButton>\r\n              <Button size=\"large\" color=\"primary\" style={{ height: 100 }} onClick={() => { this.handleButtons(\"right\"); }}>·</Button>\r\n            </div>\r\n            <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\" }}>\r\n              <Button size=\"large\" color=\"primary\" style={{ width: 100 }} onClick={() => { this.handleButtons(\"down\"); }}>·</Button>\r\n            </div>\r\n          </div>\r\n          {/* 便捷单手操作 */}\r\n          <div style={{ width: \"60%\", display: \"flex\", justifyContent: \"flex-end\", alignItems: \"center\", position: \"fixed\", bottom: \"8%\", right: \"10%\" }}>\r\n            <ButtonGroup size=\"large\" variant=\"contained\" color=\"primary\" disableElevation>\r\n              <Button onClick={() => { this.handleButtons(\"left\"); }}>&lt;  后退</Button>\r\n              <Button onClick={() => { this.handleButtons(\"right\"); }}>前进  &gt;</Button>\r\n            </ButtonGroup>\r\n          </div>\r\n        </Container>\r\n        {/* <SettingsDialog open={this.state.openSettings} config={this.config} /> */}\r\n        <Dialog onClose={this.handleSettingsClose} open={this.state.openSettings}>\r\n          <DialogTitle>设置</DialogTitle>\r\n          <TextField id=\"settings-api\" label=\"API\" variant=\"outlined\" defaultValue={this.config.data.api}/>\r\n        </Dialog>\r\n      </ThemeProvider>\r\n    </div >)\r\n  }\r\n};\r\n\r\nexport default App;","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}